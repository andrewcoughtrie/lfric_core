!-----------------------------------------------------------------------------
! (C) Crown copyright 2020 Met Office. All rights reserved.
! The file LICENCE, distributed with this code, contains details of the terms
! under which the code may be used.
!-----------------------------------------------------------------------------
!> @brief Exercises the simple I/O context.
!>
module simple_io_context_mod_test

  use clock_mod,             only : clock_type
  use constants_mod,         only : r_second, i_native
  use field_mod,             only : field_type
  use io_context_mod,        only : io_context_type
  use model_clock_mod,       only : model_clock_type
  use simple_io_context_mod, only : simple_io_context_type

  use pFUnit_mod

  implicit none

  private
  public :: test_basic_initialisation

contains

  !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
  @test
  subroutine test_basic_initialisation()

    implicit none

    type(simple_io_context_type) :: test_unit
    class(clock_type), pointer   :: clock

    ! These arguments are, as yet, unused by the context so can be passed
    ! through un-initialised
    type(field_type) :: chi(3)
    type(field_type) :: panel_id

    call test_unit%initialise( 'test_context', 1_i_native, &
                               chi, panel_id )

  end subroutine test_basic_initialisation

end module simple_io_context_mod_test
