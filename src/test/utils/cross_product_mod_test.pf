!-------------------------------------------------------------------------------
! (c) The copyright relating to this work is owned jointly by the Crown, 
! Met Office and NERC 2014. 
! However, it has been created with the help of the GungHo Consortium, 
! whose members are identified at https://puma.nerc.ac.uk/trac/GungHo/wiki
!-------------------------------------------------------------------------------
!
!-------------------------------------------------------------------------------

module cross_product_mod_test
  implicit none

contains 

  @test
  subroutine cross_product_test()

    use pFUnit_Mod
    use constants_mod, only: r_def
    use cross_product_mod, only: cross_product

    implicit none

    real(kind=r_def) :: x(3) ,y(3), z(3), x_cross_y(3) 

    x(:) = (/ 1.0_r_def,   3.0_r_def, 7.0_r_def /)
    y(:) = (/ -2.0_r_def, 10.0_r_def, 4.0_r_def /)   
   
    z = cross_product(x, y)

    x_cross_y(1) = x(2)*y(3) - y(2)*x(3)
    x_cross_y(2) = y(1)*x(3) - x(1)*y(3)
    x_cross_y(3) = x(1)*y(2) - y(1)*x(2)

    @assertEqual(z(1), x_cross_y(1))
    @assertEqual(z(2), x_cross_y(2))
    @assertEqual(z(3), x_cross_y(3))
  end subroutine cross_product_test

end module cross_product_mod_test
